# Прогнозирование оттока клиентов телеком-компании

Проект по разработке и внедрению модели машинного обучения для прогнозирования оттока клиентов телекоммуникационной компании. Включает анализ данных, обучение и оптимизацию модели, а также веб-приложение для использования модели в принятии решений.

## Описание проекта

Отток клиентов (churn) - серьезная проблема для телекоммуникационных компаний. Клиенты могут переходить к другим провайдерам по разным причинам: неудовлетворенность сервисом, более выгодные предложения конкурентов, изменение потребностей и т.д. Предсказание оттока позволяет заранее выявить клиентов с высоким риском ухода и принять меры по их удержанию.

Проект решает задачу прогнозирования оттока с помощью методов машинного обучения и включает:

1. Анализ и предобработку данных о клиентах и их поведении
2. Разработку и сравнение нескольких моделей машинного обучения
3. Оптимизацию и выбор лучшей модели (XGBoost)
4. Разработку веб-приложения для использования модели
5. Тестирование и оценку эффективности решения

## Структура проекта

```
telco_churn_prediction/
├── app/                        # Веб-приложение Flask
│   ├── __init__.py
│   ├── app.py                  # Основной файл приложения
│   ├── templates/              # HTML-шаблоны
│   │   ├── base.html           # Базовый шаблон
│   │   ├── index.html          # Страница с формой ввода
│   │   ├── result.html         # Страница с результатами
│   │   └── error.html          # Страница ошибки
│   └── utils/                  # Вспомогательные функции
│       ├── __init__.py
│       └── model_utils.py      # Функции для работы с моделью
├── data/                       # Данные проекта
│   ├── raw/                    # Исходные необработанные данные
│   ├── interim/                # Промежуточные данные
│   └── processed/              # Обработанные данные для ML
├── models/                     # Сохраненные ML модели
│   ├── best_model.joblib       # Лучшая модель (XGBoost)
│   ├── preprocessor.joblib     # Пайплайн предобработки
│   └── ...                     # Другие модели
├── src/                        # Исходный код проекта
│   ├── data/                   # Скрипты для работы с данными
│   │   └── preprocess.py       # Предобработка данных
│   ├── features/               # Работа с признаками
│   ├── models/                 # Скрипты для обучения моделей
│   │   ├── train.py            # Обучение моделей
│   │   └── optimize.py         # Оптимизация моделей
│   └── visualization/          # Визуализация
├── notebooks/                  # Jupyter-ноутбуки для анализа
│   └── 01_data_exploration.py  # Исследовательский анализ данных
├── docs/                       # Документация
│   ├── data_dictionary.md      # Описание данных
│   ├── app_architecture.md     # Архитектура приложения
│   └── figures/                # Визуализации и графики
│       └── models/             # Графики для моделей
├── tests/                      # Тесты
├── requirements.txt            # Зависимости проекта
├── README.md                   # Описание проекта
└── workflow_state.md           # Текущий статус проекта
```

## Текущее состояние проекта

В настоящее время:
- Выполнен анализ данных о клиентах и выявлены ключевые факторы, влияющие на отток
- Обучены различные модели машинного обучения (XGBoost, логистическая регрессия, случайный лес, дерево решений)
- Оптимизирована модель XGBoost, достигнуты следующие метрики:
  - Accuracy: 0.7573
  - Precision: 0.5289
  - Recall: 0.7834
  - F1-score: 0.6315
  - ROC-AUC: 0.8382
- Разработано веб-приложение на Flask для прогнозирования оттока клиентов
- Выполняется тестирование веб-приложения

## Установка и запуск

### Требования
- Python 3.8+
- Зависимости из requirements.txt, включая:
  - pandas, numpy, scikit-learn, xgboost, imbalanced-learn
  - flask, jinja2, werkzeug
  - matplotlib, seaborn

### Установка

```bash
# Клонирование репозитория
git clone <url-репозитория>
cd telco_churn_prediction

# Создание виртуального окружения
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# Установка зависимостей
pip install -r requirements.txt
```

### Использование

#### Запуск веб-приложения

```bash
# Переход в директорию приложения
cd telco_churn_prediction/app

# Запуск Flask-приложения
python app.py
```

После запуска приложение будет доступно по адресу http://127.0.0.1:5000

#### Использование API

Приложение предоставляет API-эндпоинт для программного взаимодействия:

```bash
curl -X POST -H "Content-Type: application/json" -d '{"gender":"Male","SeniorCitizen":"No","Partner":"Yes",...}' http://127.0.0.1:5000/api/predict
```

#### Анализ данных и обучение моделей

```bash
# Анализ данных
python telco_churn_prediction/notebooks/01_data_exploration.py

# Обучение моделей
python -m telco_churn_prediction.src.models.train

# Оптимизация моделей
python -m telco_churn_prediction.src.models.optimize
```

## Веб-приложение

Разработанное веб-приложение предоставляет следующие возможности:
- Ввод данных о клиенте через удобную форму
- Мгновенное прогнозирование вероятности оттока
- Визуальное представление результатов
- API для интеграции с другими системами

## Данные

В проекте используется публичный датасет "Telco Customer Churn" от IBM, содержащий данные о 7043 клиентах телеком-компании с информацией о:
- Демографических характеристиках (пол, возраст, семейное положение)
- Подключенных услугах (телефон, интернет, ТВ)
- Типе контракта и методах оплаты
- Истории и стоимости обслуживания

## Результаты

Ключевые выводы из анализа данных:
- Наибольшее влияние на отток оказывают: тип контракта, стаж клиента, способ оплаты и тип интернет-услуги
- Клиенты с месячным контрактом имеют значительно более высокий риск оттока
- Наличие дополнительных услуг (безопасность, поддержка) снижает вероятность оттока
- Оптимизированная модель XGBoost успешно выявляет более 78% клиентов, склонных к оттоку

## Архитектура приложения

Подробное описание архитектуры веб-приложения представлено в [docs/app_architecture.md](docs/app_architecture.md).

## Статус проекта

Текущий статус работы над проектом отслеживается в [workflow_state.md](workflow_state.md).

## Лицензия

[MIT](LICENSE)

## Автор

[Ваше Имя] 