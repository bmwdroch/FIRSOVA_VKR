# 2.1. Обзор методов машинного обучения для прогнозирования оттока клиентов

## 2.1.1. Постановка задачи прогнозирования оттока клиентов

Прогнозирование оттока клиентов (Customer Churn Prediction) - это задача, направленная на выявление клиентов, которые с высокой вероятностью прекратят пользоваться услугами компании в ближайшем будущем. С точки зрения машинного обучения, данная задача формулируется как задача бинарной классификации, где:

- **Класс 0 (отрицательный класс)**: клиент не уйдет (останется с компанией)
- **Класс 1 (положительный класс)**: клиент уйдет (прекратит пользоваться услугами)

Формальная постановка задачи:
- Дано: набор признаков клиента X = {x₁, x₂, ..., xₙ}, где каждый признак xᵢ описывает определенную характеристику клиента (демографические данные, сведения о контракте, история использования услуг и т.д.)
- Требуется: построить модель f: X → {0, 1}, способную предсказать вероятность ухода клиента P(y=1|X)

Особенности данной задачи:
- Несбалансированность классов (обычно "ушедших" клиентов значительно меньше, чем "оставшихся")
- Необходимость не только в точном прогнозе, но и в объяснимости модели для выявления причин оттока
- Различная стоимость ошибок классификации (цена ложноположительного прогноза отличается от цены ложноотрицательного)

![Распределение целевой переменной](../../images/references/target_distribution.png)

*Рисунок 2.1.1 - Распределение классов в задаче прогнозирования оттока клиентов*

## 2.1.2. Классификация методов машинного обучения

Методы машинного обучения, применяемые для решения задачи прогнозирования оттока клиентов, можно классифицировать по различным признакам:

### По типу обучения:
- **Методы обучения с учителем** (Supervised Learning):
  - Логистическая регрессия
  - Деревья решений и ансамбли деревьев (Random Forest, Gradient Boosting)
  - Метод опорных векторов (SVM)
  - Нейронные сети

- **Методы обучения без учителя** (Unsupervised Learning) - используются как вспомогательные:
  - Кластеризация для сегментации клиентов
  - Методы снижения размерности для предобработки данных

### По алгоритмическому подходу:
- **Линейные модели**: логистическая регрессия, линейный SVM
- **Деревья решений и их ансамбли**: Random Forest, Gradient Boosting, XGBoost
- **Вероятностные модели**: наивный байесовский классификатор
- **Нейросетевые подходы**: многослойные персептроны, глубокие сети

### По интерпретируемости:
- **Интерпретируемые модели**: логистическая регрессия, деревья решений
- **Частично интерпретируемые**: ансамбли деревьев с использованием методов интерпретации (SHAP, LIME)
- **"Черные ящики"**: сложные нейронные сети

[МЕСТО ДЛЯ ДИАГРАММЫ: Классификация методов машинного обучения]

*Рисунок 2.1.2 - Классификация методов машинного обучения для задач прогнозирования оттока*

## 2.1.3. Специфика применения ML для задач прогнозирования оттока

При применении методов машинного обучения для прогнозирования оттока клиентов необходимо учитывать ряд специфических особенностей данной предметной области:

### 1. Бизнес-ориентированность метрик

Классические метрики машинного обучения (точность, полнота) должны быть соотнесены с бизнес-метриками:
- Стоимость удержания клиента vs. стоимость потери клиента
- Различные стратегии удержания для разных групп клиентов
- ROI маркетинговых кампаний по удержанию

### 2. Временная составляющая

В отличие от многих других задач классификации, прогнозирование оттока имеет выраженную временную компоненту:
- Прогноз делается на определенный временной горизонт (1 месяц, 3 месяца, 6 месяцев)
- Необходимо учитывать сезонность и другие временные паттерны
- Исторические данные имеют разный вес (недавние события более значимы)

### 3. Активное вмешательство

Прогнозы оттока обычно используются для активного вмешательства (retention campaigns):
- Модель должна быть достаточно оперативной для принятия мер
- Необходимо учитывать эффект от предыдущих интервенций
- Желательна возможность моделирования "what-if" сценариев

### 4. Динамика данных и обновление моделей

Характер оттока клиентов может меняться со временем:
- Изменения в продуктовой линейке компании
- Действия конкурентов
- Макроэкономические факторы
- Изменения в поведении потребителей

Эти факторы требуют регулярного переобучения моделей и мониторинга их производительности.

### 5. Этические аспекты и прозрачность

При построении систем прогнозирования оттока необходимо учитывать:
- Недопустимость дискриминации клиентов по защищенным признакам
- Необходимость объяснения причин прогноза для менеджеров по работе с клиентами
- Соблюдение требований законодательства о персональных данных

[МЕСТО ДЛЯ РИСУНКА: Процесс применения ML для прогнозирования оттока]

*Рисунок 2.1.3 - Цикл разработки и внедрения системы прогнозирования оттока клиентов* 